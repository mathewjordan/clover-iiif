import A,{useEffect as xe,useState as Wo}from"react";import B from"react";import{Vault as Lo}from"@iiif/vault";var Qe={canvasBackgroundColor:"#e6e8eb",canvasHeight:"61.8vh",ignoreCaptionLabels:[],renderAbout:!0,showIIIFBadge:!0,showInformationToggle:!0,showTitle:!0},ye={activeCanvas:"",activeManifest:"",collection:{},configOptions:Qe,informationExpanded:!0,isLoaded:!1,vault:new Lo},Ye=B.createContext(ye),Je=B.createContext(ye);function Vo(e,t){switch(t.type){case"updateActiveCanvas":return t.canvasId||(t.canvasId=""),{...e,activeCanvas:t.canvasId};case"updateActiveManifest":return{...e,activeManifest:t.manifestId};case"updateCollection":return{...e,collection:t.collection};case"updateConfigOptions":return{...e,configOptions:{...Qe,...t.configOptions}};case"updateInformationExpanded":return{...e,informationExpanded:t.informationExpanded};case"updateIsLoaded":return{...e,isLoaded:t.isLoaded};default:throw new Error(`Unhandled action type: ${t.type}`)}}var et=({initialState:e=ye,children:t})=>{let[r,o]=B.useReducer(Vo,e);return B.createElement(Ye.Provider,{value:r},B.createElement(Je.Provider,{value:o},t))};function v(){let e=B.useContext(Ye);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function V(){let e=B.useContext(Je);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}import ee,{useEffect as Ke,useState as te}from"react";function tt(e){return e.service?`${e.service[0].id}/full/,${e.height||500}/0/default.jpg`:e.id}var Ce=e=>{if(!!e)try{let t=e.thumbnail;return t&&t.length>0?tt(t[0]):tt(e.items[0].items[0].body)}catch(t){console.error("Error retrieving accompanying canvas image",t);return}};var D=(e,t,r,o)=>{var s,d;let n={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},l=i=>{if(i){if(!i.body||!i.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",i);return}if(!i.body)return;let u=i.body;Array.isArray(u)&&(u=u[0]);let f=e.get(u.id);if(!f)return;switch(r){case"painting":return i.target===t.id&&i.motivation&&i.motivation[0]==="painting"&&o.includes(f.type)&&(i.body=f),i;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};return n.canvas=e.get(t),n.canvas&&(n.annotationPage=e.get(n.canvas.items[0]),n.accompanyingCanvas=(s=n.canvas)!=null&&s.accompanyingCanvas?e.get((d=n.canvas)==null?void 0:d.accompanyingCanvas):void 0),n.annotationPage&&(n.annotations=e.get(n.annotationPage.items).filter(l)),n};var W=(e,t="en")=>{if(!e)return"";if(!e[t]){let r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return e[t]};var ve=(e,t)=>{let r=D(e,{id:t,type:"Canvas"},"painting",["Image","Sound","Video"]);if(r.annotations.length!==0&&r.annotations[0]&&r.annotations[0].body)return r.annotations[0].body};var Ie=(e,t,r)=>{let o=e.get({id:t,type:"Canvas"});if(!(o!=null&&o.annotations)||!o.annotations[0])return[];let n=e.get(o.annotations[0]),l=e.get(n.items);return Array.isArray(l)?l.filter(s=>{var d;if(!!s.body&&(d=s.motivation)!=null&&d.includes("supplementing")){let i=s.body;Array.isArray(i)&&(i=i[0]);let u=e.get(i.id);if(u.format===r)return s.body=u,s}}).map(s=>s.body):[]};var we=(e,t,r,o)=>{let n=[];if(t.canvas&&t.canvas.thumbnail.length>0){let d=e.get(t.canvas.thumbnail[0]);n.push(d)}if(t.annotations[0]){if(t.annotations[0].thumbnail&&t.annotations[0].thumbnail.length>0){let i=e.get(t.annotations[0].thumbnail[0]);n.push(i)}if(!t.annotations[0].body)return;let d=t.annotations[0].body;d.type==="Image"&&n.push(d)}return n.length===0?void 0:{id:n[0].id,format:n[0].format,type:n[0].type,width:r,height:o}};import{createStitches as zo}from"@stitches/react";var No={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"#006adc",accentMuted:"#5eb0ef",accentAlt:"#00254d",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fonts:{sans:"'Inter', Arial, sans-serif",display:"'Calistoga', 'Inter', Arial, sans-serif"},transitions:{all:"all 500ms cubic-bezier(0.16, 1, 0.3, 1)"}},Se={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",xl:"(max-width: 1199px)",lg:"(min-width: 1200px)"},{styled:a,css:An,keyframes:ot,createTheme:Mn}=zo({theme:No,media:Se});import*as oe from"@radix-ui/react-collapsible";var Te=a("div",{position:"relative",zIndex:"0"}),ke=a("div",{display:"flex",flexDirection:"row",overflow:"hidden","@sm":{flexDirection:"column"}}),Fe=a("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),rt=a(oe.Trigger,{display:"none",background:"transparent",border:"none",margin:"0",padding:"0",transition:"$all",opacity:"1",marginTop:"0","&[data-navigator='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",margin:"1rem 1rem 0"}}}),Pe=a(oe.Content,{width:"100%",display:"flex"}),nt=a("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),it=a("div",{display:"flex",flexDirection:"column",fontFamily:"$sans",backgroundColor:"$secondary",fontSmooth:"auto",webkitFontSmoothing:"antialiased","> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start","@sm":{[`& ${ke}`]:{flexGrow:"1"},[`& ${Fe}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-navigator-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${Te}`]:{display:"none"},[`& ${Pe}`]:{height:"100%"}}}});import{useEffect as Bo,useState as Do}from"react";var at=e=>{let t=()=>window.matchMedia?window.matchMedia(e).matches:!1,[r,o]=Do(t);return Bo(()=>{let n=()=>o(t);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)}),r};import{useEffect as Ho,useLayoutEffect as Oo,useState as Go}from"react";var st=(e=!1)=>{let[t,r]=Go(e);return Oo(()=>{if(!t)return;let o=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=o}},[t]),Ho(()=>{t!==e&&r(e)},[e]),[t,r]};import*as Ao from"@radix-ui/react-collapsible";import S from"react";import{Popover as ut}from"@nulib/design-system";import*as z from"@radix-ui/react-select";var lt=a("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),dt=a(z.Trigger,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"$display",alignSelf:"flex-start",flexGrow:"1",backgroundColor:"$secondary",cursor:"pointer",transition:"$all",border:"1px solid $secondaryMuted",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem","@sm":{fontSize:"1rem"}}),mt=a(z.Content,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),pt=a(z.Item,{display:"flex",alignItems:"center",fontFamily:"$sans",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),ct=a(z.Label,{color:"$primaryMuted",fontFamily:"$sans",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),re=a("div",{position:"relative",zIndex:"5"});var ft=a(ut.Trigger,{width:"30px",padding:"5px",margin:"0 0 0 2rem"}),gt=a(ut.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",fontFamily:"$sans",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none",["&:last-child"]:{marginBottom:"0"}}}),ht=a("span",{fontSize:"1.25rem",fontWeight:"700",fontFamily:"$display",alignSelf:"flex-start",flexGrow:"1",flexShrink:"0","@sm":{fontSize:"1rem"}}),bt=a("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"flex-end",padding:"1rem",[`> ${re}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}});import{Popover as or}from"@nulib/design-system";import E from"react";var Uo=()=>{let e="#ed1d33",t="#2873ab";return E.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},E.createElement("title",null,"IIIF Manifest Options"),E.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},E.createElement("g",{transform:"scale(0.1)"},E.createElement("path",{style:{fill:t},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),E.createElement("path",{style:{fill:t},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),E.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),E.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),E.createElement("path",{style:{fill:t},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),E.createElement("path",{style:{fill:t},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),E.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},xt=Uo;import $e from"react";import{useCallback as jo,useEffect as Ro,useState as qo}from"react";var yt=(e,t=2500)=>{let[r,o]=qo(),n=jo(()=>{navigator.clipboard.writeText(e).then(()=>o("copied"),()=>o("failed"))},[e]);return Ro(()=>{if(!r)return;let l=setTimeout(()=>o(void 0),t);return()=>clearTimeout(l)},[r]),[r,n]};var Zo=a("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),_o=({status:e})=>e?$e.createElement(Zo,{"data-copy-status":e},e):null,Ko=({textPrompt:e,textToCopy:t})=>{let[r,o]=yt(t);return $e.createElement("button",{onClick:o},e," ",$e.createElement(_o,{status:r}))},Ee=Ko;import*as I from"@radix-ui/react-select";import{Label as Ct,Thumbnail as Qo}from"@samvera/nectar-iiif";import C from"react";import O from"react";var Xo=({direction:e,title:t})=>O.createElement(lt,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",null,t),e==="up"&&O.createElement(()=>O.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),null),e==="down"&&O.createElement(()=>O.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),null)),ne=Xo;var Yo=()=>{let e=V(),t=v(),{activeManifest:r,collection:o,configOptions:n,vault:l}=t,s=n==null?void 0:n.canvasHeight;return C.createElement(re,null,C.createElement(I.Root,{value:r,onValueChange:i=>{e({type:"updateActiveManifest",manifestId:i})}},C.createElement(dt,null,C.createElement(I.Value,null),C.createElement(I.Icon,null,C.createElement(ne,{direction:"down",title:"select from collection"}))),C.createElement(mt,{css:{maxHeight:`${s} !important`}},C.createElement(I.ScrollUpButton,null,C.createElement(ne,{direction:"up",title:"scroll up for more"})),C.createElement(I.Viewport,null,C.createElement(I.Group,null,C.createElement(ct,null,C.createElement(Ct,{label:o.label})),o.items.map(i=>C.createElement(pt,{value:i.id,key:i.id},C.createElement(Qo,{thumbnail:l.get(i.thumbnail)}),C.createElement(I.ItemText,null,C.createElement(Ct,{label:i.label})),C.createElement(I.ItemIndicator,null))))),C.createElement(I.ScrollDownButton,null,C.createElement(ne,{direction:"down",title:"scroll down for more"})))))},vt=Yo;import{Label as rr}from"@samvera/nectar-iiif";import q,{useEffect as Jo,useState as er}from"react";import*as ie from"@radix-ui/react-switch";var It=a(ie.Root,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"$secondaryAlt",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),wt=a(ie.Thumb,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),St=a("div",{display:"flex",alignItems:"center",paddingLeft:"1.618rem"}),Tt=a("label",{fontSize:"0.8333rem",fontFamily:"$sans",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",color:"$primary",opacity:"0.7",paddingRight:"0.618rem"}),kt=a("form",{});var tr=()=>{let e=V(),[t,r]=er(!0);return Jo(()=>{e({type:"updateInformationExpanded",informationExpanded:t})},[t]),q.createElement(kt,null,q.createElement(St,null,q.createElement(Tt,{htmlFor:"information-toggle",css:t?{opacity:"1"}:{}},"More Information"),q.createElement(It,{checked:t,onCheckedChange:()=>r(!t),id:"information-toggle"},q.createElement(wt,null))))},Ft=tr;var nr=({manifestId:e,manifestLabel:t})=>{let r=v(),{collection:o,configOptions:n}=r,{showTitle:l,showIIIFBadge:s,showInformationToggle:d}=n;return!(o!=null&&o.items)&&!l&&!s&&!d?S.createElement(S.Fragment,null):S.createElement(bt,{className:"clover-header"},o!=null&&o.items?S.createElement(vt,null):S.createElement(ht,null,S.createElement(rr,{label:t})),s&&S.createElement(or,null,S.createElement(ft,null,S.createElement(xt,null)),S.createElement(gt,null,(o==null?void 0:o.items)&&S.createElement("button",{onClick:i=>{i.preventDefault(),window.open(o.id,"_blank")}},"View Collection"),S.createElement("button",{onClick:i=>{i.preventDefault(),window.open(e,"_blank")}},"View Manifest")," ",(o==null?void 0:o.items)&&S.createElement(Ee,{textPrompt:"Copy Collection URL",textToCopy:o.id}),S.createElement(Ee,{textPrompt:"Copy Manifest URL",textToCopy:e}))),d&&S.createElement(Ft,null))},Pt=nr;import $ from"react";import G,{useEffect as We,useState as Le}from"react";import*as $t from"@radix-ui/react-radio-group";var Et=a($t.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"});import w from"react";var ir=e=>{var t=e.toString().split(":"),r=Math.ceil(parseInt(t[0])),o=Math.ceil(parseInt(t[1])),n=ar(Math.ceil(parseInt(t[2])),2);let s=`${r!==0&&o<10?(o+"").padStart(2,"0"):o}:${n}`;return r!==0&&(s=`${r}:${s}`),s},ae=e=>{let t=new Date(e*1e3).toISOString().substr(11,8);return ir(t)};var ar=(e,t)=>String(e).padStart(t,"0");import{Icon as Z,Tag as sr}from"@nulib/design-system";import*as Mt from"@radix-ui/react-radio-group";import{Tag as At}from"@nulib/design-system";var se=a("span",{display:"flex"}),Wt=a("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),Lt=a("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),Vt=a(Mt.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${se}`]:{position:"absolute",right:"0",bottom:"0",[`& ${At}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",color:"$primaryMuted",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${se}`]:{[`& ${At}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700",color:"$primary"}}});import{Label as lr}from"@samvera/nectar-iiif";var dr=({type:e})=>{switch(e){case"Sound":return w.createElement(Z.Audio,null);case"Image":return w.createElement(Z.Image,null);case"Video":return w.createElement(Z.Video,null);default:return w.createElement(Z.Image,null)}},mr=({canvas:e,canvasIndex:t,isActive:r,thumbnail:o,type:n,handleChange:l})=>w.createElement(Vt,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":t,onClick:()=>l(e.id),value:e.id},w.createElement("figure",null,w.createElement("div",null,(o==null?void 0:o.id)&&w.createElement("img",{src:o.id,alt:e!=null&&e.label?W(e.label):""}),w.createElement(se,null,w.createElement(sr,{isIcon:!0,"data-testid":"thumbnail-tag"},w.createElement(Wt,null),w.createElement(Z,{"aria-label":n},w.createElement(dr,{type:n})),["Video","Sound"].includes(n)&&w.createElement(Lt,null,ae(e.duration))))),(e==null?void 0:e.label)&&w.createElement("figcaption",{"data-testid":"fig-caption"},w.createElement(lr,{label:e.label})))),zt=mr;var Nt=e=>e.body?e.body.type:"Image";import g,{useEffect as ur,useState as Me}from"react";var Ae=a("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),Bt=a("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"$sans",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),le=a("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),Dt=a("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),Ht=a("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${Ae}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}});import{useEffect as pr}from"react";var cr=(e,t)=>{pr(()=>{function r(o){o.key===e&&t()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},Ot=cr;var fr=()=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.createElement("title",null,"Arrow Back"),g.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),gr=()=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.createElement("title",null,"Arrow Forward"),g.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),hr=()=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.createElement("title",null,"Close"),g.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),br=()=>g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g.createElement("title",null,"Search"),g.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),xr=({handleCanvasToggle:e,handleFilter:t,activeIndex:r,canvasLength:o})=>{let[n,l]=Me(!1),[s,d]=Me(!1),[i,u]=Me(!1);ur(()=>{u(r===0),r===o-1?d(!0):d(!1)},[r]),Ot("Escape",()=>{l(!1),t("")});let f=()=>{l(h=>!h),t("")};return g.createElement(Ht,{isToggle:n},g.createElement(Ae,null,n&&g.createElement(Bt,{autoFocus:!0,onChange:h=>t(h.target.value),placeholder:"Search"}),!n&&g.createElement(Dt,null,g.createElement(le,{onClick:()=>e(-1),disabled:i,type:"button"},g.createElement(fr,null)),g.createElement("span",null,r+1," of ",o),g.createElement(le,{onClick:()=>e(1),disabled:s,type:"button"},g.createElement(gr,null))),g.createElement(le,{onClick:f,type:"button"},n?g.createElement(hr,null):g.createElement(br,null))))},Gt=xr;var yr=({items:e})=>{let t=V(),r=v(),{activeCanvas:o,vault:n}=r,[l,s]=Le(""),[d,i]=Le([]),[u,f]=Le(0),m=G.useRef(null),h="painting",b=["Image","Sound","Video"],p=c=>{o!==c&&t({type:"updateActiveCanvas",canvasId:c})};return We(()=>{if(!d.length){let c=e.map(y=>D(n,y,h,b)).filter(y=>y.annotations.length>0);i(c)}},[]),We(()=>{d.forEach((c,y)=>{c!=null&&c.canvas&&c.canvas.id===o&&f(y)})},[o]),We(()=>{let c=document.querySelector(`[data-canvas="${u}"]`);if(c instanceof HTMLElement&&m.current){let y=c.offsetLeft-m.current.offsetWidth/2+c.offsetWidth/2;m.current.scrollTo({left:y,behavior:"smooth"})}},[u]),G.createElement(G.Fragment,null,G.createElement(Gt,{handleFilter:c=>s(c),handleCanvasToggle:c=>{let y=d[u+c];y!=null&&y.canvas&&p(y.canvas.id)},activeIndex:u,canvasLength:d.length}),G.createElement(Et,{"aria-label":"select item","data-testid":"media",ref:m},d.filter(c=>{var y;if((y=c.canvas)!=null&&y.label){let M=W(c.canvas.label);if(Array.isArray(M))return M[0].toLowerCase().includes(l.toLowerCase())}}).map((c,y)=>{var M,H;return G.createElement(zt,{canvas:c.canvas,canvasIndex:y,handleChange:p,isActive:o===((M=c==null?void 0:c.canvas)==null?void 0:M.id),key:(H=c==null?void 0:c.canvas)==null?void 0:H.id,thumbnail:we(n,c,200,200),type:Nt(c.annotations[0])})})))},Ut=yr;import P,{useEffect as Gr,useState as Ur}from"react";import*as N from"@radix-ui/react-tabs";var jt=a(N.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",boxShadow:"-5px -5px 5px #00000011","@sm":{marginTop:"0.5rem",boxShadow:"none"},"&:after":{position:"absolute",bottom:0,content:"",width:"100%",height:"1rem",backgroundImage:"linear-gradient(0deg, #FFFFFF 0%, #FFFFFF00 100%)",zIndex:1,"@sm":{backgroundImage:"none"}}}),Rt=a(N.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid $secondaryAlt",backgroundColor:"$secondary","@sm":{margin:"0 1rem"}}),Ve=a(N.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",color:"$primaryMuted",border:"none",fontFamily:"inherit",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:700,transition:"$all","&::after":{width:"0",height:"4px",content:"",backgroundColor:"$primaryMuted",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&:hover":{color:"$primary"},"&[data-state='active']":{color:"$accent","&::after":{width:"100%",backgroundColor:"$accent"}}}),ze=a(N.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1rem 0"}}),qt=a("div",{position:"relative",height:"100%",width:"100%",overflowY:"scroll"});import Be,{useEffect as wr}from"react";import*as de from"@radix-ui/react-radio-group";var Zt=ot({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),_t=a(de.Root,{display:"flex",flexDirection:"column",width:"100%"}),me=a(de.Item,{position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"$primaryMuted",border:"none",background:"none","@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{color:"$primary",backgroundColor:"$secondaryMuted",fontFamily:"$sansBold","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:Zt,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:Zt,boxSizing:"content-box","@sm":{content:"unset"}}}});import{v4 as Cr}from"uuid";var vr=()=>{function e(n){return n.map(s=>{let d=s.identifier||Cr();return{...s,identifier:d}})}function t(n){let l=e(n);function s(i,u){let f=[];return i.forEach(m=>{let b=i.filter(p=>m.start>=p.start&&m.end<=p.end&&m.identifier!==p.identifier).sort((p,T)=>{let x=p.end-p.start,c=T.end-T.start;return x===c?0:x<c?-1:1})[0];if(!b&&!u||(b==null?void 0:b.identifier)===u){let p=s(i,m.identifier);p.length&&(m.children=p),f.push(m)}}),f}return s(l,null)}function r(n,l=[]){return l.some(s=>n.start>=s.start&&n.end<=s.end)}function o(n=[]){return n.sort((l,s)=>l.start-s.start)}return{addIdentifiersToParsedCues:e,createNestedCues:t,isChild:r,orderCuesByTime:o}},Kt=vr;import ce from"react";import Ne from"react";import pe from"react";var Xt={currentTime:0,startTime:0,updateStartTime:()=>{},updateCurrentTime:()=>{}},_=pe.createContext(Xt),Qt=({children:e})=>{let[t,r]=pe.useState(Xt.currentTime),[o,n]=pe.useState(0),l=d=>n(d),s=d=>r(d);return pe.createElement(_.Provider,{value:{currentTime:t,startTime:o,updateStartTime:l,updateCurrentTime:s}},e)};var Ir=({label:e,start:t,end:r})=>{let{currentTime:o,updateStartTime:n}=Ne.useContext(_),l=t<=o&&o<r;return Ne.createElement(me,{"aria-checked":l,"data-testid":"navigator-cue",onClick:()=>{n(t)},value:e},e,Ne.createElement("strong",null,ae(t)))},Yt=Ir;var Jt=a("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${me}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}});var eo=({items:e})=>ce.createElement(Jt,null,e.map(({text:t,start:r,end:o,children:n,identifier:l})=>ce.createElement("li",{key:l},ce.createElement(Yt,{label:t,start:r,end:o}),n&&ce.createElement(eo,{items:n})))),to=eo;import{parse as Sr}from"node-webvtt";var Tr=({resource:e})=>{let[t,r]=Be.useState([]),{id:o,label:n}=e,{createNestedCues:l,orderCuesByTime:s}=Kt();return wr(()=>{fetch(o,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(d=>d.text()).then(d=>{let i=Sr(d).cues,u=s(i),f=l(u);r(f)}).catch(d=>console.error(o,d.toString()))},[o]),Be.createElement(_t,{"aria-label":`navigate ${W(n,"en")}`},Be.createElement(to,{items:t}))},oo=Tr;import{Label as jr}from"@samvera/nectar-iiif";var ro=a("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",color:"$primary",fontFamily:"$sans",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),no=a("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"});import{Homepage as kr}from"@samvera/nectar-iiif";import U from"react";var Fr=({homepage:e})=>(e==null?void 0:e.length)===0?U.createElement(U.Fragment,null):U.createElement(U.Fragment,null,U.createElement("span",{className:"manifest-property-title"},"Homepage"),U.createElement(kr,{homepage:e})),De=Fr;import ue from"react";var Pr=({id:e,htmlLabel:t,parent:r="manifest"})=>ue.createElement(ue.Fragment,null,ue.createElement("span",{className:"manifest-property-title"},t),ue.createElement("a",{href:e,target:"_blank",id:`iiif-${r}-id`},e)),He=Pr;import K from"react";import{Metadata as $r}from"@samvera/nectar-iiif";var Er=({metadata:e,parent:t="manifest"})=>e?K.createElement(K.Fragment,null,K.createElement($r,{metadata:e,id:`iiif-${t}-metadata`})):K.createElement(K.Fragment,null),Oe=Er;import X from"react";import{RequiredStatement as Ar}from"@samvera/nectar-iiif";var Mr=({requiredStatement:e,parent:t="manifest"})=>e?X.createElement(X.Fragment,null,X.createElement(Ar,{requiredStatement:e,id:`iiif-${t}-required-statement`})):X.createElement(X.Fragment,null),Ge=Mr;import j from"react";var Wr=({rights:e})=>e?j.createElement(j.Fragment,null,j.createElement("span",{className:"manifest-property-title"},"Rights"),j.createElement("a",{href:e,target:"_blank"},e)):j.createElement(j.Fragment,null),Ue=Wr;import{SeeAlso as Lr}from"@samvera/nectar-iiif";import R from"react";var Vr=({seeAlso:e})=>(e==null?void 0:e.length)===0?R.createElement(R.Fragment,null):R.createElement(R.Fragment,null,R.createElement("span",{className:"manifest-property-title"},"See Also"),R.createElement(Lr,{seeAlso:e})),je=Vr;import Q from"react";import{Summary as zr}from"@samvera/nectar-iiif";var Nr=({summary:e,parent:t="manifest"})=>e?Q.createElement(Q.Fragment,null,Q.createElement(zr,{summary:e,as:"p",id:`iiif-${t}-summary`})):Q.createElement(Q.Fragment,null),Re=Nr;import Y from"react";import{Thumbnail as Br}from"@samvera/nectar-iiif";var Dr=({label:e,thumbnail:t})=>(t==null?void 0:t.length)===0?Y.createElement(Y.Fragment,null):Y.createElement(Y.Fragment,null,Y.createElement(Br,{altAsLabel:e||{none:["resource"]},thumbnail:t})),qe=Dr;import F,{useEffect as Hr,useState as fe}from"react";var Or=()=>{let e=v(),{activeManifest:t,vault:r}=e,[o,n]=fe(),[l,s]=fe([]),[d,i]=fe([]),[u,f]=fe([]);return Hr(()=>{var h,b,p;let m=r.get(t);n(m),((h=m.homepage)==null?void 0:h.length)>0&&s(r.get(m.homepage)),((b=m.seeAlso)==null?void 0:b.length)>0&&i(r.get(m.seeAlso)),((p=m.thumbnail)==null?void 0:p.length)>0&&f(r.get(m.thumbnail))},[t,r]),o?F.createElement(no,null,F.createElement(ro,null,F.createElement(qe,{thumbnail:u,label:o.label}),F.createElement(Re,{summary:o.summary}),F.createElement(Oe,{metadata:o.metadata}),F.createElement(Ge,{requiredStatement:o.requiredStatement}),F.createElement(Ue,{rights:o.rights}),F.createElement(De,{homepage:l}),F.createElement(je,{seeAlso:d}),F.createElement(He,{id:o.id,htmlLabel:"IIIF Manifest"}))):F.createElement(F.Fragment,null)},io=Or;var Rr=({activeCanvas:e,resources:t})=>{let r=v(),{configOptions:o}=r,{renderAbout:n}=o,[l,s]=Ur();Gr(()=>{n?s("manifest-about"):t&&(t==null?void 0:t.length)>0&&!n&&s(t[0].id)},[e,t]);let d=i=>{s(i)};return t?P.createElement(jt,{"data-testid":"navigator",defaultValue:l,onValueChange:d,orientation:"horizontal",value:l},P.createElement(Rt,{"aria-label":"select chapter","data-testid":"navigator-list"},n&&P.createElement(Ve,{value:"manifest-about"},"About"),t&&t.map(({id:i,label:u})=>P.createElement(Ve,{key:i,value:i},P.createElement(jr,{label:u})))),P.createElement(qt,null,n&&P.createElement(ze,{value:"manifest-about"},P.createElement(io,null)),t&&t.map(i=>P.createElement(ze,{key:i.id,value:i.id},P.createElement(oo,{resource:i}))))):P.createElement(P.Fragment,null)},ao=Rr;import L from"react";import J from"hls.js";var so=a("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",maxHeight:"500px",zIndex:"1",video:{backgroundColor:"transparent",display:"flex",position:"relative",objectFit:"contain",width:"100%",height:"100%",zIndex:"1"}});import ge from"react";var lo=a("canvas",{position:"absolute",width:"100%",height:"100%"});var qr=ge.forwardRef((e,t)=>{let r=ge.useRef(null);ge.useEffect(()=>{!t||(t.current.onplay=o)},[t]);function o(){let l=t.current,s=new AudioContext,d=s.createMediaElementSource(l),i=s.createAnalyser(),u=r.current;if(!u)return;u.width=l.offsetWidth,u.height=l.offsetHeight;let f=u.getContext("2d");d.connect(i),i.connect(s.destination),i.fftSize=256;let m=i.frequencyBinCount,h=new Uint8Array(m);setInterval(function(){n(i,f,m,h,u.width,u.height)},20)}function n(l,s,d,i,u,f){let m=u/d*2.6,h,b=0;l.getByteFrequencyData(i),s.fillStyle="#000000",s.fillRect(0,0,u,f);for(let p=0;p<d;p++)h=i[p]*2,s.fillStyle=`rgba(${78}, 42, 132, 1)`,s.fillRect(b,f-h,m,h),b+=m+6}return ge.createElement(lo,{ref:r})}),mo=qr;import Zr from"react";var _r=({resource:e,ignoreCaptionLabels:t})=>{let r=W(e.label,"en");return r.some(n=>t.includes(n))?null:Zr.createElement("track",{key:e.id,src:e.id,label:r,srcLang:"en","data-testid":"player-track"})},po=_r;var Kr=({painting:e,resources:t})=>{var b;let r=L.useRef(null),o=(b=e==null?void 0:e.format)==null?void 0:b.includes("audio/"),{startTime:n,updateCurrentTime:l}=L.useContext(_),s=v(),{activeCanvas:d,configOptions:i,vault:u}=s,f=D(u,{id:d,type:"Canvas"},"painting",["Image"]),m=Ce(f.accompanyingCanvas);L.useEffect(()=>{if(!e.id||!r.current||e.id.split(".").pop()!=="m3u8")return;let p=new J;return p.attachMedia(r.current),p.on(J.Events.MEDIA_ATTACHED,function(){p.loadSource(e.id)}),p.on(J.Events.ERROR,function(T,x){if(x.fatal)switch(x.type){case J.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${T} network error encountered, try to recover`),p.startLoad();break;case J.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${T} media error encountered, try to recover`),p.recoverMediaError();break;default:p.destroy();break}}),()=>{p&&(p.detachMedia(),p.destroy(),l(0))}},[e.id]),L.useEffect(()=>{let p=r.current;p&&(p.currentTime=n),n!==0&&p.play()},[n]);let h=()=>{let p=r.current;p&&(p.ontimeupdate=T=>{l(T.target.currentTime)})};return L.createElement(so,{css:{backgroundColor:i.canvasBackgroundColor,maxHeight:i.canvasHeight}},L.createElement("video",{id:"clover-iiif-video",key:e.id,ref:r,controls:!0,height:e.height,width:e.width,onPlay:h,crossOrigin:"anonymous",poster:m},L.createElement("source",{src:e.id,type:e.format}),t.length>0&&t.map(p=>L.createElement(po,{resource:p,ignoreCaptionLabels:i.ignoreCaptionLabels,key:p.id})),"Sorry, your browser doesn't support embedded videos."),o&&L.createElement(mo,{ref:r}))},co=Kr;import tn,{useEffect as on,useState as So}from"react";import be,{useEffect as vo,useState as Yr}from"react";import Io from"openseadragon";var uo=a("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"}}),fo=a("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),go=a("div",{width:"100%",height:"61.8vh",maxHeight:"100vh",background:"black",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"});import k from"react";import Ze from"react";var ho=a("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",backgroundColor:"#000D",filter:"drop-shadow(5px 5px 5px #0006)",transition:"$all",boxSizing:"content-box !important",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(5px 5px 5px #000D)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&#zoomReset":{"&:hover, &:focus":{svg:{rotate:"45deg"}}}});var Xr=({id:e,label:t,children:r})=>Ze.createElement(ho,{id:e,"data-testid":"openseadragon-button"},Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${e}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},Ze.createElement("title",{id:`${e}-svg-title`},t),r)),he=Xr;var bo=a("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem"});var Qr=()=>k.createElement(bo,{"data-testid":"openseadragon-controls",id:"openseadragon-controls"},k.createElement(he,{id:"zoomIn",label:"zoom in"},k.createElement(()=>k.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),null)),k.createElement(he,{id:"zoomOut",label:"zoom in"},k.createElement(()=>k.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),null)),k.createElement(he,{id:"zoomReset",label:"reset zoom"},k.createElement(()=>k.createElement(k.Fragment,null,k.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),k.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),null))),xo=Qr;var yo=e=>fetch(`${e.replace(/\/$/,"")}/info.json`).then(t=>t.json()).then(t=>t).catch(t=>{console.error(`The IIIF tilesource ${e.replace(/\/$/,"")}/info.json failed to load: ${t}`)}),Co=e=>{let t,r;if(Array.isArray(e)&&(t=e[0],t)){let o;"@id"in t?o=t["@id"]:o=t.id,r=o}return r};import{v4 as Jr}from"uuid";var en=({uri:e,imageType:t})=>{let[r,o]=Yr(),n=v(),{configOptions:l}=n,s=Jr(),d={id:`openseadragon-viewport-${s}`,loadTilesWithAjax:!0,homeButton:"zoomReset",showFullPageControl:!1,zoomInButton:"zoomIn",zoomOutButton:"zoomOut",showNavigator:!0,navigatorBorderColor:"transparent",navigatorId:`openseadragon-navigator-${s}`,gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}};return vo(()=>{e!==r&&o(e)},[]),vo(()=>{if(r)switch(t){case"simpleImage":Io(d).addSimpleImage({url:r});break;case"tiledImage":yo(r).then(i=>Io(d).addTiledImage({tileSource:i}));break;default:console.warn(`Unable to render ${r} in OpenSeadragon as type: "${t}"`);break}},[r]),be.createElement(go,{css:{backgroundColor:l.canvasBackgroundColor,height:l.canvasHeight}},be.createElement(xo,null),be.createElement(uo,{id:`openseadragon-navigator-${s}`}),be.createElement(fo,{id:`openseadragon-viewport-${s}`}))},wo=en;var rn=({body:e})=>{let[t,r]=So(),[o,n]=So();return on(()=>{Array.isArray(e.service)&&e.service.length>0?(r("tiledImage"),n(Co(e.service))):(r("simpleImage"),n(e.id))},[e]),tn.createElement(wo,{uri:o,key:o,imageType:t})},To=rn;import{Button as nn}from"@nulib/design-system";var an=({activeCanvas:e,painting:t,resources:r,items:o,isAbout:n,isInformation:l,isNavigator:s,isNavigatorOpen:d,isMedia:i})=>$.createElement(ke,{className:"clover-content"},$.createElement(Qt,null,$.createElement(Fe,null,i?$.createElement(co,{painting:t,resources:r}):t&&$.createElement(To,{body:t,key:e}),$.createElement(rt,null,$.createElement(nn,{as:"span"},d?"View Items":"More Information")),o.length>1&&$.createElement(Te,{className:"clover-canvases"},$.createElement(Ut,{items:o,activeItem:0}))),l&&(n||s)&&$.createElement(nt,null,$.createElement(Pe,null,$.createElement(ao,{activeCanvas:e,resources:r}))))),ko=an;import _e from"react";var Fo=a("div",{display:"flex",flexDirection:"column",alignItems:"center"}),Po=a("p",{fontFamily:"$display",fontWeight:"bold",fontSize:"x-large"}),$o=a("span",{fontSize:"medium"});var sn=({error:e})=>{let{message:t}=e;return _e.createElement(Fo,{role:"alert"},_e.createElement(Po,{"data-testid":"headline"},"Something went wrong"),t&&_e.createElement($o,null,`Error message: ${t}`," "))},Eo=sn;import{ErrorBoundary as ln}from"react-error-boundary";var dn=({manifest:e,theme:t})=>{let r=v(),{activeCanvas:o,informationExpanded:n,vault:l,configOptions:s}=r,[d,i]=te(!1),[u,f]=te(!1),[m,h]=te(!0),[b,p]=te(void 0),[T,x]=te([]),[c,y]=st(!1),M=at(Se.sm);return Ke(()=>{if(!M){h(!0);return}h(!1)},[M]),Ke(()=>{if(!M){y(!1);return}y(m)},[m]),Ke(()=>{let H=ve(l,o),Xe=Ie(l,o,"text/vtt");H&&(i(["Sound","Video"].indexOf(H.type)>-1),p({...H})),x(Xe),f(Xe.length!==0)},[o]),ee.createElement(ln,{FallbackComponent:Eo},ee.createElement(it,{className:`${t} clover-iiif`,"data-body-locked":c,"data-navigator":u,"data-navigator-open":m},ee.createElement(Ao.Root,{open:m,onOpenChange:h},ee.createElement(Pt,{manifestLabel:e.label,manifestId:e.id}),ee.createElement(ko,{activeCanvas:o,painting:b,resources:T,items:e.items,isAbout:s.renderAbout,isMedia:d,isInformation:n,isNavigator:u,isNavigatorOpen:m}))))},Mo=dn;import{createTheme as mn}from"@stitches/react";var pn=({canvasIdCallback:e=()=>{},customTheme:t,id:r,manifestId:o,options:n})=>A.createElement(A.Fragment,null,"Testing... Clover... ",r," ..#2",A.createElement(et,null,A.createElement(cn,{id:r,manifestId:o,canvasIdCallback:e,customTheme:t,options:n}))),cn=({canvasIdCallback:e,customTheme:t,id:r,manifestId:o,options:n})=>{let l=V(),s=v(),{activeCanvas:d,activeManifest:i,isLoaded:u,vault:f}=s,[m,h]=Wo(),[b,p]=Wo(),T={};return t&&(T=mn("custom",t)),xe(()=>{e&&e(d)},[d]),xe(()=>{i&&f.loadManifest(i).then(x=>{p(x),l({type:"updateActiveCanvas",canvasId:x.items[0]&&x.items[0].id})}).catch(x=>{console.error(`Manifest failed to load: ${x}`)}).finally(()=>{l({type:"updateIsLoaded",isLoaded:!0})})},[i]),xe(()=>{let x=r;o&&(x=o),l({type:"updateConfigOptions",configOptions:n}),f.load(x).then(c=>{h(c)}).catch(c=>{console.error(`The IIIF resource ${x} failed to load: ${c}`)})},[r,n]),xe(()=>{let x=[];(m==null?void 0:m.type)==="Collection"?(l({type:"updateCollection",collection:m}),x=m.items.filter(c=>c.type==="Manifest").map(c=>c.id),x.length>0&&l({type:"updateActiveManifest",manifestId:x[0]})):(m==null?void 0:m.type)==="Manifest"&&l({type:"updateActiveManifest",manifestId:m.id})},[m]),u?!b||!b.items?(console.log(`The IIIF manifest ${o} failed to load.`),A.createElement(A.Fragment,null)):b.items.length===0?(console.log(`The IIIF manifest ${o} does not contain canvases.`),A.createElement(A.Fragment,null)):A.createElement(Mo,{manifest:b,theme:T,key:b.id}):A.createElement(A.Fragment,null,"Loading")},Rl=pn;export{Rl as default};
